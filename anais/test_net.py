from keras.models import load_model
import numpy as np

#data = np.load('../data/data_matrix.npz')['arr_0'][55:58]
#data = np.reshape(data, (3, 1221, 242))
#labels = np.load('../data/labels.npz')['arr_0']
#print('True label : ', labels[55:58])

model = load_model('encoder.h5')
predictions = model.predict_on_batch(data)

print('First prediction:', predictions)

'''
data = np.array([ 8.07869956e-02 , 1.16699804e-02 ,-3.72680098e-01 ,-2.15319082e-01,
  -5.50116241e-01, -2.23235011e-01 , 3.37139443e-02 ,-2.05173150e-01,
  -5.54216802e-01, -2.84441143e-01 , 4.28838134e-01, -3.55991036e-01,
   7.33272493e-01,  2.34428763e-01 ,-7.16939688e-01 , 7.48392701e-01,
  -6.37299359e-01,  2.20930185e-02 , 1.44953147e-01 ,-2.61956573e-01,
   1.04639297e-02,  7.31624007e-01 ,-2.48549134e-01 ,-4.18586135e-01,
   5.70896983e-01,  1.40197366e-01 , 5.21174371e-01 , 1.06896803e-01,
  -5.88901103e-01, -5.68621933e-01 ,-8.71327460e-01 ,-3.07901114e-01,
  -8.85029554e-01, -9.18788239e-02 ,-7.08456695e-01 ,-2.58341223e-01,
  -1.66502833e-01,  9.33755562e-03 ,-1.64862201e-01 , 2.21344411e-01,
   1.37658775e-01, -1.68698356e-01 ,-3.05099130e-01 ,-6.18859947e-01,
  -3.49484742e-01,  7.17407167e-01 ,-2.14305073e-02 , 3.32003869e-02,
   6.79196358e-01, -2.00185969e-01 , 2.18879823e-02 ,-2.21153677e-01,
  -4.85078067e-01,  3.59258711e-01 , 6.65740192e-01 ,-9.37343314e-02,
  -3.82193364e-02,  1.53230230e-05 ,-2.92655915e-01 , 4.92536247e-01,
   1.85264900e-01,  1.16499558e-01 ,-8.65536705e-02 , 5.32643497e-01,
   8.05739582e-01, -2.78579086e-01 , 2.24415004e-01 ,-1.92132443e-01,
   7.72990286e-02, -5.95506728e-02 , 6.32277071e-01 , 5.40940106e-01,
   3.08532476e-01, -6.76230565e-02 , 3.96515131e-01 ,-2.59026945e-01,
   9.01943445e-02, -2.33193234e-01 , 4.17494506e-01 ,-2.63985157e-01,
  -1.70743972e-01, -4.26546991e-01 , 7.13549275e-03 , 3.83077152e-02,
   3.26852389e-02,  6.53425604e-02 ,-2.78710216e-01 ,-8.91991481e-02,
  -2.28398651e-01,  3.55831116e-01 ,-4.49314207e-01 ,-1.26884207e-01,
  -4.77411985e-01, -2.06138372e-01 , 3.97007972e-01 ,-3.95382009e-03,
   2.46003076e-01,  2.79269740e-02 ,-3.60272378e-01 , 3.80472600e-01,
  -4.08236057e-01, -6.31938696e-01 , 1.55017331e-01 ,-3.78643781e-01,
  -4.57673609e-01, -4.76167768e-01 , 4.89801675e-01 ,-1.25423595e-02,
  -5.91956496e-01,  9.30087641e-02 ,-6.01666451e-01 , 6.64331853e-01,
   2.24320889e-01, -5.02666712e-01 ,-2.72853732e-01 , 0.00000000e+00,
  -3.96571867e-03,  3.14161479e-02 , 2.97123104e-01 ,-2.57934332e-01,
  -2.75742143e-01, -8.36557031e-01 , 3.30848969e-03 , 2.19718277e-01,
   1.85968921e-01, -3.75633031e-01 , 2.18321756e-02 ,-2.60517508e-01])

[ 4.84763719e-02  2.08103910e-01 -5.51377389e-06 -4.53281492e-01
  -1.56821147e-01 -3.34778130e-01 -3.70181590e-01 -6.15664005e-01
  -7.23448992e-02  9.54957604e-01  2.22924545e-01 -8.95054996e-01
  -4.29073006e-01  2.20464945e-01 -6.35114133e-01  2.41877154e-01
  -3.16079855e-01  9.46252704e-01  1.09017074e-01  2.01014318e-02
   2.22067512e-03 -7.65309453e-01  4.80804861e-01  3.54090482e-01
   8.59481633e-01 -3.58770937e-01  5.38209975e-01  3.18968505e-01
  -5.61510026e-02  8.22492316e-02  2.01669410e-01 -1.32787168e-01
  -4.44108129e-01  1.53939635e-01  2.27056891e-01  7.51458202e-03
  -4.17892128e-01  6.16135538e-01  5.60590215e-02  2.05259472e-01
  -2.18458861e-01 -5.02835870e-01  1.24274291e-01 -7.35678613e-01
  -8.96839052e-02  2.51342058e-01 -3.95830125e-01  3.06790292e-01
  -7.63924531e-15  2.87021194e-02 -7.41149843e-01 -2.86308944e-01
  -3.52854724e-03 -2.33155526e-02 -4.12776262e-01 -4.23328429e-02
  -5.33947051e-01 -2.72048295e-01 -7.03707218e-01 -2.40620255e-01
  -1.28229737e-01 -1.11567356e-01 -2.72050947e-01 -5.05539775e-01
   3.45217437e-01 -6.70360327e-02 -4.50352132e-01 -1.84725598e-01
  -0.00000000e+00 -3.49403381e-01  3.37794982e-02  1.43136695e-01
   2.36026078e-01  4.07311201e-01 -2.08377779e-01  2.65909314e-01
  -4.73009020e-01 -7.55249429e-03  8.12423706e-01 -4.60932761e-01
   2.68774867e-01 -5.08927584e-01  1.40274882e-01 -1.22544870e-01
   4.56325933e-02 -2.81457812e-01  1.37732252e-01  1.38596475e-01
  -3.88959378e-01 -1.28244191e-01  7.82418013e-01 -4.27072018e-01
   1.25979006e-01  2.23684549e-01 -2.41311103e-01 -3.59877497e-01
   1.80023849e-01  1.06529512e-01 -9.87392217e-02 -1.82980584e-12
   0.00000000e+00 -4.75474596e-01  5.55003574e-03 -9.45711076e-01
   9.59175453e-02 -3.14982861e-01  2.00583454e-04  1.98347762e-01
   3.48803848e-02  9.99991953e-01 -8.34652781e-03  4.66035396e-01
  -6.63469434e-01  1.89668220e-02 -2.56556533e-02  2.90316433e-01
   7.44242370e-02  4.96598631e-01 -1.36005268e-01 -6.98024407e-02
   7.23277688e-01  4.31875110e-01 -6.74769759e-01  1.30767301e-01
   2.31355995e-01  8.96180689e-01  3.22214663e-01  1.40961453e-01]
 [-7.51096666e-01  2.76273459e-01 -4.83697891e-01 -5.09795733e-03
   2.75574744e-01  4.71118778e-01  3.01947035e-02 -8.01969290e-01
   5.34092844e-01 -1.78763196e-01  1.52616158e-01  6.41770363e-02
   1.28595373e-02 -9.49711919e-01  0.00000000e+00 -7.03659132e-02
   1.18957786e-03 -1.06466368e-01 -4.00601834e-01  2.95127779e-01
  -7.43178070e-01  0.00000000e+00 -1.30407259e-01  7.72458076e-01
  -2.01467127e-01 -3.44776899e-01 -1.75545260e-01  2.22259223e-01
  -5.34473993e-02  3.06640446e-01 -0.00000000e+00 -1.50768207e-02
   2.34779925e-03  4.80674267e-01 -1.96632668e-02 -3.37666839e-01
   2.37170294e-01 -3.38532597e-01  3.75528097e-01 -7.00710416e-01
  -6.81976080e-01  4.63667184e-01  1.17504574e-01  1.73884053e-02
  -7.30706155e-01 -0.00000000e+00  1.83491707e-01  2.34116558e-02
   9.99999404e-01 -4.18657541e-01 -6.13792658e-01  4.41686630e-01
  -4.61798221e-01 -2.05228999e-01  1.07175112e-01  4.25571203e-01
   5.77355802e-01  1.35092959e-01  4.22488809e-01  1.20265760e-01
   2.45581735e-02 -4.09953576e-03  8.11040699e-01 -1.22592412e-01
  -2.42997795e-01 -1.98706746e-01 -6.34542048e-01 -2.03411832e-01
  -9.84228194e-01  2.89298277e-02 -5.77517033e-01 -8.12750012e-02
  -2.07832828e-01  2.16919303e-01 -0.00000000e+00  1.17621310e-01
   9.18482337e-03  4.88420486e-01 -1.71713427e-01  1.07019536e-01
  -6.50260389e-01  1.32344455e-01 -1.03182979e-01 -8.44827831e-01
  -8.06200266e-01  0.00000000e+00  7.10604608e-01  2.13149428e-01
   5.07512093e-01 -2.42762476e-01 -1.52378783e-01 -6.12338066e-01
   9.37097473e-04 -4.04781908e-01  1.07040711e-01  2.70708650e-01
   1.07075982e-02 -0.00000000e+00 -1.82318449e-01  8.69548559e-01
   4.93736714e-01  0.00000000e+00  9.26825583e-01 -1.72054898e-02
   3.06277573e-01  1.56913251e-01 -1.62988871e-01 -1.84214160e-01
   4.09695119e-01 -6.65614247e-01 -0.00000000e+00 -1.55021297e-02
  -2.52122015e-01  4.33811069e-01 -1.83976099e-01 -3.65739733e-01
  -6.70200408e-01 -1.25781089e-01  3.30157131e-01 -4.15902287e-01
   0.00000000e+00  1.13588102e-01 -6.73072860e-02  3.79454285e-01
  -3.13519128e-02 -6.26839325e-02  2.86450982e-01  8.37153971e-01]'''

[[5.9982675e-01 6.2893055e-02 2.7467829e-01 6.2601864e-02 7.0119352e-31]
 [7.7537328e-02 3.7283358e-01 2.2456935e-01 3.2505977e-01 6.7330274e-19]
 [5.5230092e-02 8.7464899e-01 2.6746828e-02 4.3374080e-02 1.1293585e-12]]


{0: [96, 90, 84, 80, 710], 1: [149, 137, 137, 167, 0], 2: [91, 133, 92, 98, 0], 3: [100, 104, 107, 111, 0], 4: [132, 108, 155, 119, 0]}